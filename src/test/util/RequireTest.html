<!DOCTYPE html>
<html>
<head>
<title>Require Test</title>

<script type="text/javascript" src="http://yui.yahooapis.com/combo?3.3.0/build/yui/yui-min.js"></script>

<script type="text/javascript"> window.DEBUG = true; </script>
<script type="text/javascript" src="../../main/util/Namespace.js"></script>
<script type="text/javascript" src="../../main/util/Util.js"></script>
<script type="text/javascript" src="../../main/util/Require.js"></script>

</head>
<body>
<script type="text/javascript">
    YUI().use("test", function(Y){
    	
       	window.test;
        var protoFactory;
        var testCase = new Y.Test.Case({
            name : "Require Test",

            setUp : function(){				         
                
            	window.test = {};
            },

            tearDown : function(){

                protoFactory = null;
            },
			            
            testGet : function(){
            	
            	var scripts = [
            	    "../resources/RequireTest1.js",
            	    "../resources/RequireTest2.js",
            	    "../resources/RequireTest3.js",
            	];
            	
            	Y.Assert.isUndefined(test.RequireTest1);
            	Y.Assert.isUndefined(test.RequireTest2);
            	Y.Assert.isUndefined(test.RequireTest3);
            	
            	var require = new inverted.util.Require(1000);
            	require.load(scripts, function(success) {
            		
					Y.Assert.isTrue(success);		            		
            		Y.Assert.isNotUndefined(test.RequireTest1);
                	Y.Assert.isNotUndefined(test.RequireTest2);
                	Y.Assert.isNotUndefined(test.RequireTest3);
            	});
            },

			testGet404 : function(){
            	
            	var scripts = [
            	    "../resources/RequireTest1.js",
            	    "../resources/RequireTest2.js",
            	    "../resources/RequireTest3.js",
            	    
            	    //do not work
            	    "../resources/RequireTest400.js",
            	    "../resources/RequireTest404.js",
            	];
            	
            	var require = new inverted.util.Require(1000);
            	
            	var _success, _notLoaded, _message;            	
           		require.load(scripts, function(success, notLoaded, message) {
           			_success = success;
           			_notLoaded = notLoaded;
           			_message = message;           			
           		});	
           		
           		this.wait(function()
           		{
           			Y.Assert.isFalse(_success);
           			Y.Assert.isArray(_notLoaded);
           			Y.Assert.isString(_message);
           			Y.Assert.areEqual(2, _notLoaded.length);
           		}, 1200);
            }            
        });

        Y.Test.Runner.add(testCase);

        var TestRunner = Y.Test.Runner;
        TestRunner.run();

    });
</script>
</body>
</html>
