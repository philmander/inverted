/*
 Inverted IOC container v0.1.1

 https://github.com/philmander/inverted-js

 Copyright (c) 2013, Phil Mander
 Licensed under the MIT license
*/
"function"!==typeof define&&(define=require("amdefine")(module));
define("inverted/ProtoFactory",function(){var g=function(b){this.config=b;this.dependencyMap={}};g.prototype.addDependencies=function(b){for(var f in b)b.hasOwnProperty(f)&&(this.dependencyMap[f]=b[f])};g.prototype.getProto=function(b){b=this.getProtoConfig(b);var f=null;"static"===b.scope?"string"===typeof b.module&&(f=this.dependencyMap[b.module]):!b.scope||"singleton"!==b.scope||"singleton"===b.scope&&!b.instance?(f=this._createInstance(b.module,b.args,b.props,b.extendsRef),b.scope&&"singleton"===
b.scope&&(b.instance=f)):f=b.instance;return f};g.prototype._createInstance=function(b,f,c,d){var a=null;"string"===typeof b&&(b=this.dependencyMap[b]);a=this._createArgs(f);d&&this._extendProto(b,this.getProto(d));switch(a.length){case 0:a=new b;break;case 1:a=new b(a[0]);break;case 2:a=new b(a[0],a[1]);break;case 3:a=new b(a[0],a[1],a[2]);break;case 4:a=new b(a[0],a[1],a[2],a[3]);break;case 5:a=new b(a[0],a[1],a[2],a[3],a[4]);break;case 6:a=new b(a[0],a[1],a[2],a[3],a[4],a[5]);break;case 7:a=new b(a[0],
a[1],a[2],a[3],a[4],a[5],a[6]);break;case 8:a=new b(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]);break;case 9:a=new b(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]);break;case 10:a=new b(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9]);break;default:throw Error("Instances have 10 arg limit");}if(c)for(var e in c)c.hasOwnProperty(e)&&(b=this._createArgs([c[e]]),"function"===typeof a[e]?a[e].call(a,b[0]):a[e]=b[0]);return a};g.prototype._getProtoFromFactory=function(b,f){var c=this.getProto(b);if(f)return c[f].apply(c);
throw Error("No factory method defined with "+b);};g.prototype._createArgs=function(b){var f=[];if(b)for(var c=0;c<b.length;c++){var d=b[c];if(null===d||"undefined"===typeof d)f[c]=d;else{var a="object"===typeof d;if(a&&d.ref||"string"===typeof d&&null!==d.match(/^\*[^\*]/))f[c]=this.getProto(d.ref||d.substr(1));else if(a&&d.factoryRef)f[c]=this._getProtoFromFactory(d.factoryRef,d.factoryMethod);else if(a&&d.module)f[c]=this._createInstance(d.module,d.args,d.props,null);else if(a){f[c]={};for(var e in d)d.hasOwnProperty(e)&&
(a=d[e],f[c][e]=a&&(a.ref||"string"===typeof a&&!1!==a.match(/^\*[^\*]/))?this.getProto(a.ref||a.substr(1)):a&&a.factoryRef?this._getProtoFromFactory(a.factoryRef,a.factoryMethod):a&&a.module?this._createInstance(a.module,a.args,a.props,null):a)}else f[c]=d}}return f};g.prototype._extendProto=function(b,f){var c={},d;for(d in b.prototype)c[d]=b.prototype[d];b.prototype=f;b.prototype._super=f.constructor;for(var a in c)b.prototype[a]=c[a];b.prototype.constructor=b};g.prototype.getProtoConfig=function(b){var f=
this.config;if(this.config.hasOwnProperty(b))return f[b];throw Error("No proto is defined for "+b);};return g});
define("inverted/AppContext",["inverted/ProtoFactory"],function(g){var b=function(b,c,d){this.config=b;this.protoFactory=c;this.originalModule=d||module;this._loader=define.amd&&"undefined"!==typeof requirejs?require:define.amd&&"undefined"!==typeof curl?curl:this._commonRequire};b.create=function(f,c){var d=new g(f.protos);return new b(f,d,c)};b.loader=function(b){this._loader=b};b.prototype.getProto=function(){var b=this,c=Array.prototype.slice.call(arguments,0),d;1<c.length&&"function"===typeof c[c.length-
1]&&(d=c.pop());for(var a=[],e=0;e<c.length;e++)a=a.concat(this._getDependencies(c[e]));if(!this._loader)throw Error("No AMD _loader is defined");this._loader(a,function(){var g={};for(e=0;e<a.length;e++)g[a[e]]=arguments[e];b.protoFactory.addDependencies(g);g=[];for(e=0;e<c.length;e++){var h=b.protoFactory.getProto(c[e]);g.push(h)}d&&d.apply(b,g)})};b.prototype._getDependencies=function(b,c){c=c||[];var d=this.protoFactory.getProtoConfig(b);c.push(d.module);d.extendsRef&&(c=this._getDependencies(d.extendsRef,
c));d.args&&(c=this._getDependenciesFromArgs(d.args,c));if(d.props)for(var a in d.props)d.props.hasOwnProperty(a)&&(c=this._getDependenciesFromArgs([d.props[a]],c));return c};b.prototype._getDependenciesFromArgs=function(b,c){if(b)for(var d=0;d<b.length;d++){var a=b[d];if(!(null===a||"undefined"===typeof a)){var e="object"===typeof a;if(e&&a.ref||"string"===typeof a&&null!==a.match(/^\*[^\*]/))c=this._getDependencies(a.ref||a.substr(1),c);else if(e&&a.factoryRef)c=this._getDependencies(a.factoryRef,
c);else if(e&&a.module)c.push(a.module);else if(e)for(var g in a)a.hasOwnProperty(g)&&((e=a[g])&&(e.ref||"string"===typeof e&&null!==e.match(/^\*[^\*]/))?c=this._getDependencies(e.ref||e.substr(1),c):e&&e.factoryRef?c=this._getDependencies(e.factoryRef,c):e&&e.module&&c.push(e.module))}}return c};b.prototype._commonRequire=function(b,c){var d=this,a=[];b.forEach(function(b){a.push(d.originalModule.require(b))});c.apply(this,a)};return b});define(["inverted/AppContext"],function(g){return g});